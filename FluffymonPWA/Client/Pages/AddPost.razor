@page "/post"
@using System.Timers
@layout MainLayout
@inject NavigationManager NavManager
@using FluffymonPWA.Client.Models
@inject HttpClient Http

<h1>Information about the lost pet</h1>


<div class="make-post-container">
    <div class="form-container">
        <EditForm Model="@post" OnValidSubmit="MakePost">
            <div class="form-group">
                <InputText id="title" class="form-control" placeholder="Title"
                           @bind-Value="post.Title" />
                <ValidationMessage For="@(() => post.Title)" />
            </div>
            <div class="form-group">
                <InputText id="description" class="form-control" placeholder="Description"
                           @bind-Value="post.Description" />
                <ValidationMessage For="@(() => post.Description)" />
            </div>
            <div class="form-group">
                <InputText id="reward" class="form-control" placeholder="Reward"
                           @bind-Value="post.Reward" />
                <ValidationMessage For="@(() => post.Reward)" />
            </div>

            <div class="form-group">
                <input class="btn btn-primary btn-block" type="submit" value="Submit" />
            </div>
        </EditForm>
    </div>
</div>
@code {
    private Post post = new Post();
    private string res = "";
    private static Timer timer;

    protected async Task MakePost()
    {
        post.Date = DateTime.Now;
        HttpResponseMessage response = await
            Http.PostAsJsonAsync<Post>("/api/v1/post", post);
        if (response.StatusCode.ToString() == "OK")
        {
            res = "Post created succesfully";
        }
        else
        {
            res = "Something went wrong when creating the post.";
        }
    }
}
